# IWMS 项目架构说明

## 🏗️ 整体架构

IWMS是一个完整的文件管理系统，采用前后端分离的架构设计，包含桌面应用和Web服务两个部分。

```
IWMS 完整系统架构
├── 🖥️ 桌面客户端 (Electron + Vue 3)
│   ├── 用户界面 (Vue 3 + Element Plus)
│   ├── 本地文件处理 (Node.js)
│   └── 进程间通信 (IPC)
├── 🌐 Web管理界面 (Vue 3 + Element Plus)
│   ├── 在线文件管理
│   ├── 任务监控面板
│   └── 系统管理控制台
└── 🔧 后端服务 (Spring Boot)
    ├── RESTful API
    ├── 文件处理服务
    ├── 任务调度管理
    └── 数据持久化
```

## 📁 项目结构

```
IWMS/
├── 📦 桌面应用 (Electron)
│   ├── electron/                 # Electron主进程
│   │   ├── main.js              # 主进程入口
│   │   ├── preload.js           # 预加载脚本
│   │   ├── utils/               # 工具模块
│   │   │   ├── fileScanner.js   # 文件扫描
│   │   │   ├── excelProcessor.js # Excel处理
│   │   │   ├── imageCompressor.js # 图片压缩
│   │   │   └── reportExporter.js # 报告导出
│   │   └── services/            # 核心服务
│   │       └── renameService.js # 重命名服务
│   ├── src/                     # 渲染进程 (Vue 3)
│   │   ├── App.vue             # 主应用组件
│   │   ├── views/              # 页面组件
│   │   └── router/             # 路由配置
│   ├── public/                 # 静态资源
│   └── dist/                   # 构建输出
├── 🌐 后端服务 (Spring Boot)
│   ├── src/main/java/com/iwms/
│   │   ├── IwmsBackendApplication.java # 主启动类
│   │   ├── controller/         # 控制器层
│   │   ├── service/           # 服务层
│   │   ├── repository/        # 数据访问层
│   │   ├── entity/            # 实体类
│   │   └── dto/               # 数据传输对象
│   ├── src/main/resources/
│   │   └── application.yml    # 配置文件
│   └── pom.xml               # Maven配置
├── 📚 文档
│   ├── README.md             # 项目说明
│   ├── ARCHITECTURE.md       # 架构说明
│   └── docs/                 # 详细文档
└── 🛠️ 工具脚本
    ├── scripts/              # 构建脚本
    └── backend/              # 后端脚本
```

## 🔄 数据流架构

### 桌面应用数据流
```
用户操作 → Vue组件 → IPC通信 → Electron主进程 → 文件系统操作 → 结果返回
```

### Web应用数据流
```
用户操作 → Vue组件 → HTTP请求 → Spring Boot API → 业务逻辑处理 → 数据库 → 响应返回
```

### 混合模式数据流
```
桌面应用 ↔ HTTP API ↔ 后端服务 ↔ 数据库
```

## 🎯 核心功能模块

### 1. 文件管理模块
- **文件扫描**: 递归扫描目录，支持文件过滤
- **批量重命名**: 基于Excel映射表的智能重命名
- **图片压缩**: 多线程批量图片压缩
- **文件预览**: 操作前预览功能

### 2. 任务管理模块
- **任务创建**: 支持多种任务类型
- **任务调度**: 异步任务执行
- **进度监控**: 实时任务进度跟踪
- **结果报告**: 详细的执行报告

### 3. 数据管理模块
- **任务历史**: 完整的任务执行记录
- **统计信息**: 系统使用统计
- **配置管理**: 系统参数配置

## 🔧 技术栈对比

| 功能 | 桌面应用 | 后端服务 |
|------|----------|----------|
| **前端框架** | Vue 3 + Element Plus | Vue 3 + Element Plus |
| **后端框架** | Node.js (Electron) | Spring Boot 3.2 |
| **数据库** | 文件系统 | H2/MySQL |
| **文件处理** | fs-extra, sharp | Apache POI, Thumbnailator |
| **任务调度** | 主进程 | Spring Async |
| **API通信** | IPC | RESTful API |
| **部署方式** | 桌面应用 | Web服务 |

## 🌟 架构优势

### 1. 灵活性
- **独立运行**: 桌面应用可独立运行，无需网络
- **云端扩展**: 后端服务提供云端能力
- **混合模式**: 支持本地+云端混合使用

### 2. 可扩展性
- **模块化设计**: 功能模块独立，易于扩展
- **微服务架构**: 后端服务可独立部署
- **插件机制**: 支持功能插件扩展

### 3. 可维护性
- **代码分离**: 前后端代码清晰分离
- **标准化**: 遵循行业标准架构
- **文档完善**: 完整的架构文档

### 4. 性能优化
- **本地处理**: 桌面应用本地处理，响应快速
- **异步执行**: 后端任务异步处理
- **多线程**: 支持多线程并行处理

## 🔐 安全架构

### 1. 桌面应用安全
- **进程隔离**: 主进程和渲染进程隔离
- **权限控制**: 文件系统访问权限控制
- **输入验证**: 用户输入严格验证

### 2. 后端服务安全
- **身份认证**: JWT令牌认证
- **权限管理**: 基于角色的权限控制
- **数据加密**: 敏感数据加密存储
- **API安全**: RESTful API安全防护

## 📊 监控架构

### 1. 桌面应用监控
- **错误日志**: 详细的错误日志记录
- **性能监控**: 应用性能指标监控
- **用户行为**: 用户操作行为分析

### 2. 后端服务监控
- **健康检查**: Spring Boot Actuator
- **性能指标**: 系统性能指标监控
- **业务统计**: 业务数据统计分析

## 🚀 部署架构

### 1. 桌面应用部署
```
开发环境 → 构建 → 打包 → 分发
```

### 2. 后端服务部署
```
开发环境 → 测试环境 → 生产环境
```

### 3. 容器化部署
```
Docker镜像 → 容器编排 → 服务部署
```

## 🔄 集成方案

### 1. 桌面应用与后端集成
- **配置管理**: 通过配置文件连接后端
- **API调用**: HTTP API调用后端服务
- **数据同步**: 本地数据与云端同步

### 2. 多端数据同步
- **任务同步**: 任务状态多端同步
- **配置同步**: 用户配置云端同步
- **历史同步**: 操作历史云端备份

## 📈 扩展规划

### 1. 短期扩展
- **Web管理界面**: 基于Vue 3的Web管理界面
- **移动端应用**: React Native移动应用
- **API网关**: 统一的API网关服务

### 2. 长期扩展
- **微服务架构**: 拆分为多个微服务
- **云原生部署**: Kubernetes容器编排
- **AI功能**: 智能文件分类和处理
- **协作功能**: 多用户协作处理

## 🛠️ 开发指南

### 1. 桌面应用开发
```bash
# 安装依赖
npm install

# 启动开发环境
npm run electron:dev

# 构建应用
npm run electron:build
```

### 2. 后端服务开发
```bash
# 进入后端目录
cd backend

# 启动服务
./start.sh

# 或使用Maven
mvn spring-boot:run
```

### 3. 集成开发
```bash
# 启动完整系统
# 1. 启动后端服务
cd backend && ./start.sh

# 2. 启动桌面应用
npm run electron:dev
```

## 📝 总结

IWMS采用现代化的前后端分离架构，既保持了桌面应用的便捷性，又具备了Web服务的扩展性。通过模块化设计和标准化接口，系统具有良好的可维护性和可扩展性，能够满足不同场景下的文件管理需求。
